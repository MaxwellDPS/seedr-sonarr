# Docker Compose for Seedr-Sonarr Proxy
# 
# Usage:
#   1. Copy .env.example to .env and fill in your Seedr credentials
#   2. Run: docker-compose up -d
#   3. Configure Sonarr/Radarr to use qBittorrent at http://seedr-sonarr:8080
#

services:
  seedr-sonarr:
    build: .
    image: ghcr.io/maxwelldps/seedr-sonarr
    container_name: seedr-sonarr
    restart: unless-stopped
    environment:
      - SEEDR_EMAIL=${SEEDR_EMAIL:-}
      - SEEDR_PASSWORD=${SEEDR_PASSWORD:-}
      - SEEDR_TOKEN=${SEEDR_TOKEN:-}
      - HOST=0.0.0.0
      - PORT=8080
      # qBittorrent API Credentials (used by Sonarr/Radarr)
      - USERNAME=${USERNAME:-admin}
      - PASSWORD=${PASSWORD:-adminadmin}
      - DOWNLOAD_PATH=/downloads
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - TZ=${TZ:-UTC}

    ports:
      - "${SEEDR_SONARR_PORT:-8080}:8080"
    
    volumes:
      # Download directory - mount your media library
      - ${DOWNLOAD_PATH:-./downloads}:/downloads
      # Config directory for persistent storage
      - ${CONFIG_PATH:-./config}:/config
    
    healthcheck:
      test: ["CMD", "python", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8080/health')"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  sonarr:
    image: linuxserver/sonarr:latest
    container_name: sonarr
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Los_Angeles
    volumes:
      - ./sonarr/config:/config
      - ./downloads:/downloads
      - ./media/tv:/tv
    ports:
      - 8989:8989
    restart: unless-stopped
    depends_on:
      - seedr-sonarr

  radarr:
    image: linuxserver/radarr:latest
    container_name: radarr
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Los_Angeles
    volumes:
      - ./radarr/config:/config
      - ./downloads:/downloads
      - ./media/movies:/movies
    ports:
      - 7878:7878
    restart: unless-stopped
    depends_on:
      - seedr-sonarr

